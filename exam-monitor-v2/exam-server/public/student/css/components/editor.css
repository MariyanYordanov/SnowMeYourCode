/* 
   Monaco Editor Integration
   Editor styling, controls, and enhanced features
*/

/* =================================
   MONACO EDITOR CONTAINER
   ================================= */

   .monaco-editor-container {
       position: relative;
       flex: 1;
       min-height: 300px;
       background: var(--editor-bg);
       overflow: hidden;
   }

   #monaco-editor {
       position: absolute !important;
       top: 0;
       left: 0;
       right: 0;
       bottom: 0;
       height: 100% !important;
       width: 100% !important;
   }

   .editor-content {
       display: flex;
       flex-direction: column;
       flex: 1;
       min-height: 0;
       overflow: hidden;
   }

   .console-container {
       height: 200px;
       min-height: 100px;
       max-height: 50%;
       border-top: 1px solid var(--editor-border);
       background: var(--console-bg);
       display: flex;
       flex-direction: column;
       overflow: hidden;
       flex-shrink: 0;
   }

/* =================================
   EDITOR CONTROLS
   ================================= */

.editor-controls {
    display: flex;
    gap: var(--spacing-sm);
    align-items: center;
}

.editor-controls button {
    padding: var(--spacing-xs) var(--spacing-md);
    border: 1px solid var(--editor-border);
    border-radius: var(--btn-border-radius);
    background: rgba(255, 255, 255, 0.1);
    color: var(--editor-text);
    font-size: var(--font-sm);
    cursor: pointer;
    transition: var(--transition-all);
    user-select: none;
}

.editor-controls button:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: var(--primary-color);
    transform: translateY(-1px);
}

.editor-controls button:active {
    transform: translateY(0);
}

.editor-controls button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

/* Specific button styles */
.btn-success {
    background: var(--success-color);
    border-color: var(--success-color);
    color: white;
}

.btn-success:hover {
    background: #45a049;
    border-color: #45a049;
}

.btn-secondary {
    background: var(--text-muted);
    border-color: var(--text-muted);
    color: white;
}

.btn-secondary:hover {
    background: #5a6268;
    border-color: #5a6268;
}
/* САМО тези стилове, които липсват в editor.css */

/* Липсващи бутон класове */
.btn-primary {
    background: var(--primary-color) !important;
    border-color: var(--primary-color) !important;
    color: white !important;
}

.btn-primary:hover {
    background: var(--secondary-color) !important;
    border-color: var(--secondary-color) !important;
}

.btn-danger {
    background: var(--danger-color) !important;
    border-color: var(--danger-color) !important;
    color: white !important;
}

.btn-danger:hover {
    background: #c82333 !important;
    border-color: #c82333 !important;
}

/* Поправка за специфични проблеми */
.layout-btn {
    background-color: var(--editor-panel-bg) !important;
}

.layout-btn.active {
    background-color: var(--primary-color) !important;
    color: white !important;
}

/* DevTools поправка */
.devtools-tabs {
    height: auto !important;
}

.devtool-tab {
    min-height: 32px !important;
    display: block !important;
}

/* File buttons - само икони */
.file-action-btn {
    font-size: 0 !important;
}

.file-action-btn::before {
    font-size: 14px !important;
}

/* =================================
   THEME SELECTOR
   ================================= */

#theme-selector {
    padding: var(--spacing-xs) var(--spacing-sm);
    background: var(--editor-panel-bg);
    color: var(--editor-text);
    border: 1px solid var(--editor-border);
    border-radius: var(--btn-border-radius);
    font-size: var(--font-sm);
    cursor: pointer;
}

#theme-selector:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
}

/* =================================
   MONACO EDITOR ENHANCEMENTS
   ================================= */

/* Error line highlighting */
.monaco-editor.vs-dark .error-line {
    background-color: rgba(255, 107, 107, 0.15) !important;
}

.monaco-editor.vs .error-line {
    background-color: rgba(255, 107, 107, 0.25) !important;
}

.monaco-editor.hc-black .error-line {
    background-color: rgba(255, 255, 255, 0.1) !important;
    border: 1px solid #ff6b6b !important;
}

/* Warning line highlighting */
.monaco-editor .warning-line {
    background-color: rgba(255, 193, 7, 0.1) !important;
}

/* Quality hint decorations */
.monaco-editor .quality-hint {
    border-bottom: 2px dotted var(--warning-color);
}

/* Enhanced scrollbar for Monaco */
.monaco-editor .monaco-scrollable-element>.scrollbar {
    background: var(--editor-panel-bg);
}

.monaco-editor .monaco-scrollable-element>.scrollbar>.slider {
    background: rgba(255, 255, 255, 0.2);
}

.monaco-editor .monaco-scrollable-element>.scrollbar>.slider:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* =================================
   CODE EXECUTION FEEDBACK
   ================================= */

.execution-status {
    position: absolute;
    top: var(--spacing-md);
    right: var(--spacing-md);
    padding: var(--spacing-xs) var(--spacing-md);
    background: var(--success-color);
    color: white;
    border-radius: var(--btn-border-radius);
    font-size: var(--font-xs);
    font-weight: var(--font-medium);
    opacity: 0;
    transform: translateY(-10px);
    transition: var(--transition-all);
    z-index: var(--z-tooltip);
    pointer-events: none;
}

.execution-status.show {
    opacity: 1;
    transform: translateY(0);
}

.execution-status.error {
    background: var(--danger-color);
}

.execution-status.warning {
    background: var(--warning-color);
    color: var(--text-primary);
}

/* =================================
   AUTO-SAVE INDICATOR
   ================================= */

.auto-save-indicator {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--font-xs);
    color: var(--text-muted);
    opacity: 0;
    transition: opacity var(--transition-fast);
}

.auto-save-indicator.saving {
    opacity: 1;
    color: var(--warning-color);
}

.auto-save-indicator.saved {
    opacity: 1;
    color: var(--success-color);
}

.auto-save-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
    animation: pulse 1s infinite;
}

/* =================================
   KEYBOARD SHORTCUTS OVERLAY
   ================================= */

.shortcuts-overlay {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: var(--spacing-xl);
    border-radius: var(--card-border-radius);
    max-width: 400px;
    z-index: var(--z-modal);
    opacity: 0;
    visibility: hidden;
    transition: var(--transition-all);
}

.shortcuts-overlay.show {
    opacity: 1;
    visibility: visible;
}

.shortcuts-overlay h3 {
    margin-bottom: var(--spacing-lg);
    text-align: center;
    color: white;
}

.shortcut-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-sm);
    padding: var(--spacing-xs) 0;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.shortcut-key {
    font-family: var(--font-mono);
    background: rgba(255, 255, 255, 0.2);
    padding: 2px 6px;
    border-radius: 3px;
    font-size: var(--font-xs);
}

.shortcut-description {
    font-size: var(--font-sm);
    color: #e0e0e0;
}

/* =================================
   CODE SUGGESTIONS
   ================================= */

.code-suggestions {
    position: absolute;
    bottom: var(--spacing-md);
    left: var(--spacing-md);
    right: var(--spacing-md);
    background: var(--editor-panel-bg);
    border: 1px solid var(--editor-border);
    border-radius: var(--card-border-radius);
    padding: var(--spacing-md);
    z-index: var(--z-tooltip);
    opacity: 0;
    transform: translateY(10px);
    transition: var(--transition-all);
    pointer-events: none;
}

.code-suggestions.show {
    opacity: 1;
    transform: translateY(0);
    pointer-events: all;
}

.suggestion-header {
    font-size: var(--font-sm);
    font-weight: var(--font-medium);
    color: var(--primary-color);
    margin-bottom: var(--spacing-sm);
}

.suggestion-text {
    font-size: var(--font-sm);
    color: var(--editor-text);
    line-height: var(--line-height-relaxed);
}

.suggestion-code {
    font-family: var(--font-mono);
    background: rgba(255, 255, 255, 0.1);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: 3px;
    font-size: var(--font-xs);
    color: #90cdf4;
}

/* =================================
   PERFORMANCE INDICATORS
   ================================= */

.performance-stats {
    position: absolute;
    bottom: var(--spacing-sm);
    right: var(--spacing-sm);
    font-size: var(--font-xs);
    color: var(--text-muted);
    background: rgba(0, 0, 0, 0.3);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: 3px;
    font-family: var(--font-mono);
    z-index: var(--z-base);
}

.perf-metric {
    margin-right: var(--spacing-sm);
}

.perf-value {
    color: var(--success-color);
    font-weight: var(--font-medium);
}

/* =================================
   LANGUAGE MODE INDICATOR
   ================================= */

.language-indicator {
    position: absolute;
    top: var(--spacing-sm);
    left: var(--spacing-sm);
    background: var(--primary-color);
    color: white;
    padding: 2px var(--spacing-xs);
    border-radius: 3px;
    font-size: var(--font-xs);
    font-weight: var(--font-medium);
    text-transform: uppercase;
    z-index: var(--z-base);
    opacity: 0;
    transition: opacity var(--transition-fast);
}

.language-indicator.show {
    opacity: 1;
}

.language-indicator.javascript {
    background: #f7df1e;
    color: #000;
}

.language-indicator.html {
    background: #e34f26;
}

.language-indicator.css {
    background: #1572b6;
}

/* Button fixes */
#run-btn,
#run-code-btn {
    background: #007acc !important;
    color: white !important;
    border: none !important;
    padding: 6px 16px !important;
    font-weight: 500 !important;
    cursor: pointer;
    transition: all 0.2s;
}

#run-btn:hover,
#run-code-btn:hover {
    background: #005a9e !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

#run-btn:disabled,
#run-code-btn:disabled {
    background: #6c757d !important;
    cursor: not-allowed;
    opacity: 0.7;
}

#format-btn,
#format-code-btn {
    background: transparent !important;
    color: var(--editor-text) !important;
    border: 1px solid var(--editor-border) !important;
    padding: 6px 16px !important;
}

#format-btn:hover,
#format-code-btn:hover {
    background: rgba(255, 255, 255, 0.1) !important;
    border-color: var(--primary-color) !important;
}

#clear-btn,
#clear-output-btn {
    background: transparent !important;
    color: var(--text-muted) !important;
    border: 1px solid var(--editor-border) !important;
    padding: 6px 16px !important;
}

#clear-btn:hover,
#clear-output-btn:hover {
    color: var(--danger-color) !important;
    border-color: var(--danger-color) !important;
}

#finish-exam-btn {
    background: var(--danger-color) !important;
    color: white !important;
    border: none !important;
    padding: 8px 20px !important;
    font-weight: 600 !important;
    cursor: pointer;
    transition: all 0.2s;
}

#finish-exam-btn:hover {
    background: #c82333 !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
}


/* =================================
   EDITOR SPLIT VIEW SUPPORT
   ================================= */

.editor-split {
    display: flex;
    height: 100%;
}

.editor-pane {
    flex: 1;
    position: relative;
    min-width: 0;
}

.editor-pane+.editor-pane {
    border-left: 1px solid var(--editor-border);
}

.split-handle {
    width: 4px;
    background: var(--editor-border);
    cursor: col-resize;
    transition: background-color var(--transition-fast);
}

.split-handle:hover {
    background: var(--primary-color);
}

/* =================================
   ACCESSIBILITY ENHANCEMENTS
   ================================= */

.monaco-editor {
    /* Ensure proper focus management */
    outline: none;
}

.monaco-editor:focus-within {
    box-shadow: inset 0 0 0 2px var(--primary-color);
}

/* High contrast mode adjustments */
@media (prefers-contrast: high) {
    .monaco-editor.vs-dark .error-line {
        background-color: rgba(255, 0, 0, 0.3) !important;
        border: 2px solid #ff0000 !important;
    }

    .editor-controls button {
        border-width: 2px;
    }

    .editor-controls button:focus {
        outline: 3px solid var(--primary-color);
        outline-offset: 2px;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {

    .execution-status,
    .code-suggestions,
    .shortcuts-overlay {
        transition: none;
    }

    .auto-save-dot {
        animation: none;
    }
}